# Movie Query Logger

–ü—Ä–æ–µ–∫—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ñ–∏–ª—å–º–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö **MySQL (`sakila`)**, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ **MongoDB** –∏ –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤.  
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–∞–∫ **–∫–æ–Ω—Å–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (CLI)** –Ω–∞ Python –∏ Jupyter Notebook.

---

## üìå –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- –ü–æ–∏—Å–∫ —Ñ–∏–ª—å–º–æ–≤:
  - –ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É
  - –ø–æ –∂–∞–Ω—Ä—É –∏ –¥–∏–∞–ø–∞–∑–æ–Ω—É –≥–æ–¥–æ–≤
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ MongoDB
- –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –¢–û–ü-5 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–µ –º–µ–Ω—é (CLI)

---

## üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Python 3
- Jupyter Notebook
- MySQL (`sakila`)
- MongoDB
- PyMongo
- mysql-connector-python
- Aggregation Pipeline (MongoDB)

---

## üóÑÔ∏è –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MySQL

```python
import mysql.connector

conn = mysql.connector.connect(
    host='ich-db.edu.itcareerhub.de',
    port='3306',
    user='ich1',
    password='password',
    database='sakila'
)

cursor = conn.cursor()
```

---

## üîå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MongoDB

```python
from pymongo import MongoClient

client = MongoClient(
    "mongodb://<username>:<password>@mongo.itcareerhub.de/?readPreference=primary&ssl=false&authMechanism=DEFAULT&authSource=ich_edit"
)

db = client["ich_edit"]
collection = db["final_project_dam130625_H_Ovsiannikova"]
```

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –ü–∞—Ä–æ–ª–∏ –ª—É—á—à–µ —Ö—Ä–∞–Ω–∏—Ç—å –≤ `.env` –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∞ –Ω–µ –≤ –∫–æ–¥–µ.

---

## üß© –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è

```python
from datetime import datetime

def current_datetime():
    return datetime.now().strftime('%Y-%m-%d %H:%M:%S')
```

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–∞

```python
def write_to_mongo(results, query_type, params):
    doc = {
        "timestamp": current_datetime(),
        "query_type": query_type,
        "params": params,
        "count": len(results),
        "results": results
    }
    collection.insert_one(doc)
    print("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ MongoDB.")
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

```python
show_last_queries()
```

### –¢–û–ü-5 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

```python
show_popular_queries()
```

---

## üñ•Ô∏è –ö–æ–Ω—Å–æ–ª—å–Ω–æ–µ –º–µ–Ω—é (CLI)

```text
1 - –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É
2 - –ü–æ–∏—Å–∫ –ø–æ –∂–∞–Ω—Ä—É –∏ –¥–∏–∞–ø–∞–∑–æ–Ω—É –≥–æ–¥–æ–≤
3 - –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –∑–∞–ø—Ä–æ—Å–æ–≤
4 - –ü–æ–∫–∞–∑–∞—Ç—å –¢–û–ü-5 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
0 - –í—ã—Ö–æ–¥
```

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–∏–ø –ø–æ–∏—Å–∫–∞ –∏ –≤–∏–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.  
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ MongoDB.

---

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- **MySQL (sakila)** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤  
- **MongoDB** ‚Äî —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ª–æ–≥–æ–≤ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏  
- **Python CLI / Jupyter Notebook** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ –∫–æ–¥  
- **Aggregation Pipeline** ‚Äî –ø–æ–¥—Å—á—ë—Ç –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤  

---

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è:

- —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–º–∏ –∏ NoSQL –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö  
- –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ MySQL + MongoDB  
- –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
- –±–∞–∑–æ–≤–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤  
- —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö CLI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ Python  

---

## üë©‚Äçüíª –ê–≤—Ç–æ—Ä

**Hanna Ovsiannikova**  
–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç IT Career Hub

